<mxGraphModel dx="1422" dy="762" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1654" pageHeight="1169" math="0" shadow="1">
  <root>
    <mxCell id="0" />
    <mxCell id="1" parent="0" />

    <!-- ═══════════════════════════════════════════════════════════════
         TITLE
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="title" value="AI Deal Manager — Technical Architecture" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=22;fontStyle=1;fontColor=#0F172A;" vertex="1" parent="1">
      <mxGeometry x="200" y="20" width="1260" height="40" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER LABELS
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="lbl_ext" value="External Services" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="70" width="120" height="30" as="geometry" />
    </mxCell>
    <mxCell id="lbl_client" value="Client Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="200" width="80" height="30" as="geometry" />
    </mxCell>
    <mxCell id="lbl_app" value="Application Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="360" width="120" height="30" as="geometry" />
    </mxCell>
    <mxCell id="lbl_async" value="Async Workers" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="590" width="110" height="30" as="geometry" />
    </mxCell>
    <mxCell id="lbl_data" value="Data Layer" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="730" width="80" height="30" as="geometry" />
    </mxCell>
    <mxCell id="lbl_obs" value="Observability" style="text;html=1;strokeColor=none;fillColor=none;align=left;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=11;fontStyle=1;fontColor=#64748B;rotation=-90;" vertex="1" parent="1">
      <mxGeometry x="30" y="900" width="90" height="30" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 0 — EXTERNAL SERVICES
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_ext" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F5F9;strokeColor=#CBD5E1;verticalAlign=top;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="80" y="60" width="1520" height="100" as="geometry" />
    </mxCell>

    <mxCell id="samgov" value="SAM.gov API" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEF3C7;strokeColor=#D97706;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="110" y="90" width="150" height="50" as="geometry" />
    </mxCell>
    <mxCell id="anthropic" value="Anthropic Claude&#xa;(claude-sonnet-4-6 / opus-4-6)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EDE9FE;strokeColor=#7C3AED;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="300" y="90" width="220" height="50" as="geometry" />
    </mxCell>
    <mxCell id="openai" value="OpenAI API&#xa;(Fallback LLM)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#ECFDF5;strokeColor=#059669;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="560" y="90" width="180" height="50" as="geometry" />
    </mxCell>
    <mxCell id="smtp" value="SMTP / Email" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEF3C7;strokeColor=#D97706;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="780" y="90" width="150" height="50" as="geometry" />
    </mxCell>
    <mxCell id="ext_other" value="External Data Sources&#xa;(market intel, legal refs)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F5F9;strokeColor=#94A3B8;fontStyle=0;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="970" y="90" width="200" height="50" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 1 — CLIENT + NGINX
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_client" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" vertex="1" parent="1">
      <mxGeometry x="80" y="180" width="1520" height="110" as="geometry" />
    </mxCell>

    <mxCell id="browser" value="Web Browser&#xa;(Desktop / Mobile)" style="shape=mxgraph.cisco.computers_and_peripherals.pc;html=1;pointerEvents=1;dashed=0;fillColor=#DBEAFE;strokeColor=#2563EB;strokeWidth=2;align=center;fontSize=11;fontStyle=1;shape=mxgraph.android.phone2;aspect=fixed;" vertex="1" parent="1">
      <mxGeometry x="200" y="200" width="55" height="90" as="geometry" />
    </mxCell>
    <mxCell id="browser_lbl" value="User Browser&#xa;/ Mobile App" style="text;html=1;align=center;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="175" y="255" width="110" height="30" as="geometry" />
    </mxCell>

    <mxCell id="nginx" value="NGINX Reverse Proxy&#xa;Port 80 / 443 (3027 dev)&#xa;SSL Termination + Routing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#0F172A;strokeColor=#334155;fontColor=#FFFFFF;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="580" y="200" width="300" height="70" as="geometry" />
    </mxCell>

    <!-- NGINX routes label -->
    <mxCell id="nginx_routes" value="/app/* → :3000&#xa;/api/* → :8001&#xa;/ws/* → :8002&#xa;/ai/* → :8003&#xa;/langfuse/* → :8004" style="text;html=1;align=left;fontSize=9;fontColor=#475569;" vertex="1" parent="1">
      <mxGeometry x="900" y="195" width="180" height="80" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 2 — APPLICATION SERVICES
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_app" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" vertex="1" parent="1">
      <mxGeometry x="80" y="310" width="1520" height="250" as="geometry" />
    </mxCell>

    <!-- Frontend -->
    <mxCell id="frontend_bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#EFF6FF;strokeColor=#3B82F6;" vertex="1" parent="1">
      <mxGeometry x="100" y="325" width="280" height="220" as="geometry" />
    </mxCell>
    <mxCell id="frontend_title" value="Frontend — Next.js 14" style="text;html=1;fontStyle=1;fontSize=12;fillColor=none;strokeColor=none;fontColor=#1D4ED8;" vertex="1" parent="1">
      <mxGeometry x="110" y="330" width="260" height="25" as="geometry" />
    </mxCell>
    <mxCell id="fe1" value="React 18 + TypeScript 5.3" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#93C5FD;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="115" y="358" width="255" height="28" as="geometry" />
    </mxCell>
    <mxCell id="fe2" value="Tailwind CSS 3.4 — Light / Dark Themes" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#93C5FD;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="115" y="392" width="255" height="28" as="geometry" />
    </mxCell>
    <mxCell id="fe3" value="Zustand State Management" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#93C5FD;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="115" y="426" width="255" height="28" as="geometry" />
    </mxCell>
    <mxCell id="fe4" value="Radix UI + Lucide Icons" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#93C5FD;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="115" y="460" width="255" height="28" as="geometry" />
    </mxCell>
    <mxCell id="fe5" value="22 Dashboard Pages (App Router)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#93C5FD;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="115" y="494" width="255" height="28" as="geometry" />
    </mxCell>
    <mxCell id="fe_port" value=":3000" style="ellipse;whiteSpace=wrap;html=1;fillColor=#2563EB;strokeColor=#1D4ED8;fontColor=#FFFFFF;fontSize=10;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="316" y="328" width="50" height="25" as="geometry" />
    </mxCell>

    <!-- Django API -->
    <mxCell id="django_bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F0FDF4;strokeColor=#22C55E;" vertex="1" parent="1">
      <mxGeometry x="405" y="325" width="310" height="220" as="geometry" />
    </mxCell>
    <mxCell id="django_title" value="Django 5.1 REST API" style="text;html=1;fontStyle=1;fontSize=12;fillColor=none;strokeColor=none;fontColor=#15803D;" vertex="1" parent="1">
      <mxGeometry x="415" y="330" width="290" height="25" as="geometry" />
    </mxCell>
    <mxCell id="dj1" value="18 Domain Apps + DRF + Swagger" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCFCE7;strokeColor=#86EFAC;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="420" y="358" width="285" height="28" as="geometry" />
    </mxCell>
    <mxCell id="dj2" value="JWT Auth + RBAC (9 roles) + MFA" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCFCE7;strokeColor=#86EFAC;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="420" y="392" width="285" height="28" as="geometry" />
    </mxCell>
    <mxCell id="dj3" value="30 API Endpoint Groups" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCFCE7;strokeColor=#86EFAC;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="420" y="426" width="285" height="28" as="geometry" />
    </mxCell>
    <mxCell id="dj4" value="Celery Task Dispatch + Beat Schedule" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCFCE7;strokeColor=#86EFAC;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="420" y="460" width="285" height="28" as="geometry" />
    </mxCell>
    <mxCell id="dj5" value="Audit Middleware + pgvector Search" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DCFCE7;strokeColor=#86EFAC;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="420" y="494" width="285" height="28" as="geometry" />
    </mxCell>
    <mxCell id="dj_port" value=":8001" style="ellipse;whiteSpace=wrap;html=1;fillColor=#16A34A;strokeColor=#15803D;fontColor=#FFFFFF;fontSize=10;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="656" y="328" width="50" height="25" as="geometry" />
    </mxCell>

    <!-- AI Orchestrator -->
    <mxCell id="ai_bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FAF5FF;strokeColor=#A855F7;" vertex="1" parent="1">
      <mxGeometry x="740" y="325" width="340" height="220" as="geometry" />
    </mxCell>
    <mxCell id="ai_title" value="AI Orchestrator — FastAPI + LangGraph" style="text;html=1;fontStyle=1;fontSize=12;fillColor=none;strokeColor=none;fontColor=#7E22CE;" vertex="1" parent="1">
      <mxGeometry x="750" y="330" width="320" height="25" as="geometry" />
    </mxCell>
    <mxCell id="ai1" value="21 Specialized AI Agents (LangGraph)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E8FF;strokeColor=#D8B4FE;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="755" y="358" width="310" height="28" as="geometry" />
    </mxCell>
    <mxCell id="ai2" value="12 MCP Tool Servers" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E8FF;strokeColor=#D8B4FE;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="755" y="392" width="310" height="28" as="geometry" />
    </mxCell>
    <mxCell id="ai3" value="RAG Pipeline — pgvector Embeddings" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E8FF;strokeColor=#D8B4FE;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="755" y="426" width="310" height="28" as="geometry" />
    </mxCell>
    <mxCell id="ai4" value="RL Learning — Contextual Bandit" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E8FF;strokeColor=#D8B4FE;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="755" y="460" width="310" height="28" as="geometry" />
    </mxCell>
    <mxCell id="ai5" value="Streaming Responses + Langfuse Tracing" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F3E8FF;strokeColor=#D8B4FE;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="755" y="494" width="310" height="28" as="geometry" />
    </mxCell>
    <mxCell id="ai_port" value=":8003" style="ellipse;whiteSpace=wrap;html=1;fillColor=#9333EA;strokeColor=#7E22CE;fontColor=#FFFFFF;fontSize=10;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="1022" y="328" width="50" height="25" as="geometry" />
    </mxCell>

    <!-- Realtime -->
    <mxCell id="rt_bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFF7ED;strokeColor=#F97316;" vertex="1" parent="1">
      <mxGeometry x="1105" y="325" width="270" height="220" as="geometry" />
    </mxCell>
    <mxCell id="rt_title" value="Realtime — Node.js + Socket.IO" style="text;html=1;fontStyle=1;fontSize=12;fillColor=none;strokeColor=none;fontColor=#C2410C;" vertex="1" parent="1">
      <mxGeometry x="1115" y="330" width="250" height="25" as="geometry" />
    </mxCell>
    <mxCell id="rt1" value="WebSocket Server (Socket.IO 4.7)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEDD5;strokeColor=#FED7AA;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1120" y="358" width="245" height="28" as="geometry" />
    </mxCell>
    <mxCell id="rt2" value="JWT Auth Middleware" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEDD5;strokeColor=#FED7AA;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1120" y="392" width="245" height="28" as="geometry" />
    </mxCell>
    <mxCell id="rt3" value="Live Proposal Collaboration" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEDD5;strokeColor=#FED7AA;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1120" y="426" width="245" height="28" as="geometry" />
    </mxCell>
    <mxCell id="rt4" value="Push Notifications" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEDD5;strokeColor=#FED7AA;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1120" y="460" width="245" height="28" as="geometry" />
    </mxCell>
    <mxCell id="rt5" value="AI Response Streaming" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FFEDD5;strokeColor=#FED7AA;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1120" y="494" width="245" height="28" as="geometry" />
    </mxCell>
    <mxCell id="rt_port" value=":8002" style="ellipse;whiteSpace=wrap;html=1;fillColor=#EA580C;strokeColor=#C2410C;fontColor=#FFFFFF;fontSize=10;fontStyle=1;" vertex="1" parent="1">
      <mxGeometry x="1320" y="328" width="50" height="25" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 3 — ASYNC WORKERS
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_async" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" vertex="1" parent="1">
      <mxGeometry x="80" y="580" width="1520" height="120" as="geometry" />
    </mxCell>

    <mxCell id="celery_worker" value="Celery Worker&#xa;Async Task Processor&#xa;(18 app task modules)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEF9C3;strokeColor=#CA8A04;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="350" y="600" width="260" height="80" as="geometry" />
    </mxCell>
    <mxCell id="celery_beat" value="Celery Beat&#xa;Task Scheduler&#xa;(cron jobs, periodic scans)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FEF9C3;strokeColor=#CA8A04;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="650" y="600" width="260" height="80" as="geometry" />
    </mxCell>
    <mxCell id="worker_tasks" value="SAM.gov scans • Opportunity scoring • Embedding generation&#xa;AI agent tasks • Email delivery • Report generation" style="text;html=1;align=center;fontSize=10;fontColor=#78350F;" vertex="1" parent="1">
      <mxGeometry x="950" y="615" width="560" height="50" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 4 — DATA LAYER
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_data" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" vertex="1" parent="1">
      <mxGeometry x="80" y="720" width="1520" height="150" as="geometry" />
    </mxCell>

    <!-- PostgreSQL -->
    <mxCell id="postgres" value="PostgreSQL 16 + pgvector&#xa;Primary Database&#xa;Port 5432" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#EFF6FF;strokeColor=#2563EB;fontStyle=1;fontSize=11;direction=south;" vertex="1" parent="1">
      <mxGeometry x="140" y="740" width="220" height="110" as="geometry" />
    </mxCell>
    <mxCell id="pg_detail" value="18 schemas • Vector embeddings&#xa;Audit logs • RBAC • State machine&#xa;3,241+ lines of models" style="text;html=1;align=center;fontSize=9;fontColor=#1E40AF;" vertex="1" parent="1">
      <mxGeometry x="140" y="820" width="220" height="40" as="geometry" />
    </mxCell>

    <!-- Redis -->
    <mxCell id="redis" value="Redis 7&#xa;Cache + Message Broker&#xa;Port 6379" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#FFF1F2;strokeColor=#E11D48;fontStyle=1;fontSize=11;direction=south;" vertex="1" parent="1">
      <mxGeometry x="420" y="740" width="200" height="100" as="geometry" />
    </mxCell>
    <mxCell id="redis_detail" value="Session cache • Celery broker&#xa;Rate limiting • WebSocket pub/sub" style="text;html=1;align=center;fontSize=9;fontColor=#9F1239;" vertex="1" parent="1">
      <mxGeometry x="420" y="820" width="200" height="40" as="geometry" />
    </mxCell>

    <!-- MinIO -->
    <mxCell id="minio" value="MinIO&#xa;S3-Compatible Storage&#xa;Port 9000 / 9001" style="shape=cylinder3;whiteSpace=wrap;html=1;fillColor=#F0FDF4;strokeColor=#16A34A;fontStyle=1;fontSize=11;direction=south;" vertex="1" parent="1">
      <mxGeometry x="690" y="740" width="200" height="100" as="geometry" />
    </mxCell>
    <mxCell id="minio_detail" value="RFP documents • Proposal files&#xa;Avatars • Attachments • Reports" style="text;html=1;align=center;fontSize=9;fontColor=#166534;" vertex="1" parent="1">
      <mxGeometry x="690" y="820" width="200" height="40" as="geometry" />
    </mxCell>

    <!-- pgvector detail box -->
    <mxCell id="pgvec_box" value="pgvector Extension&#xa;• Opportunity embeddings&#xa;• Knowledge vault search&#xa;• Past performance similarity&#xa;• Proposal content matching" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#DBEAFE;strokeColor=#3B82F6;fontSize=10;align=left;spacingLeft=8;" vertex="1" parent="1">
      <mxGeometry x="960" y="740" width="250" height="110" as="geometry" />
    </mxCell>

    <mxCell id="data_network" value="All services communicate on internal Docker network: dealmanager-net&#xa;No direct external database access — all via application layer" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F1F5F9;strokeColor=#94A3B8;fontSize=10;fontStyle=2;" vertex="1" parent="1">
      <mxGeometry x="1240" y="760" width="340" height="60" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LAYER 5 — OBSERVABILITY
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="bg_obs" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#CBD5E1;" vertex="1" parent="1">
      <mxGeometry x="80" y="890" width="1520" height="90" as="geometry" />
    </mxCell>

    <mxCell id="langfuse" value="Langfuse 2.50&#xa;LLM Observability — Port 8004&#xa;Traces • Scores • Feedback Loops" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#FDF4FF;strokeColor=#C026D3;fontStyle=1;fontSize=11;" vertex="1" parent="1">
      <mxGeometry x="250" y="905" width="320" height="60" as="geometry" />
    </mxCell>
    <mxCell id="obs_detail" value="LLM call tracing • Token usage • Latency • Agent step visibility&#xa;Prompt versioning • A/B evaluation • Quality scoring" style="text;html=1;align=center;fontSize=10;fontColor=#86198F;" vertex="1" parent="1">
      <mxGeometry x="610" y="910" width="600" height="50" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         CONNECTIONS — Arrows
    ═══════════════════════════════════════════════════════════════ -->

    <!-- Browser → NGINX -->
    <mxCell id="e1" value="HTTPS" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;exitX=1;exitY=0.5;entryX=0;entryY=0.5;strokeColor=#2563EB;fontColor=#2563EB;fontSize=9;" edge="1" parent="1" source="browser" target="nginx">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- NGINX → Frontend -->
    <mxCell id="e2" value="/app/*" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#3B82F6;fontSize=9;" edge="1" parent="1" source="nginx" target="frontend_bg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- NGINX → Django -->
    <mxCell id="e3" value="/api/*" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#22C55E;fontSize=9;" edge="1" parent="1" source="nginx" target="django_bg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- NGINX → AI Orchestrator -->
    <mxCell id="e4" value="/ai/*" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#A855F7;fontSize=9;" edge="1" parent="1" source="nginx" target="ai_bg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- NGINX → Realtime -->
    <mxCell id="e5" value="/ws/*" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#F97316;fontSize=9;" edge="1" parent="1" source="nginx" target="rt_bg">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Django → PostgreSQL -->
    <mxCell id="e6" value="ORM / SQL" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#2563EB;fontSize=9;" edge="1" parent="1" source="django_bg" target="postgres">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Django → Redis -->
    <mxCell id="e7" value="Cache / Queue" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#E11D48;fontSize=9;" edge="1" parent="1" source="django_bg" target="redis">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Django → MinIO -->
    <mxCell id="e8" value="File Storage" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#16A34A;fontSize=9;" edge="1" parent="1" source="django_bg" target="minio">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- AI Orchestrator → PostgreSQL (pgvector) -->
    <mxCell id="e9" value="asyncpg / pgvector" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#7C3AED;fontSize=9;" edge="1" parent="1" source="ai_bg" target="postgres">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- AI Orchestrator → Anthropic -->
    <mxCell id="e10" value="LLM calls" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#7C3AED;fontSize=9;exitX=0.5;exitY=0;entryX=0.5;entryY=1;" edge="1" parent="1" source="ai_bg" target="anthropic">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- AI Orchestrator → SAM.gov -->
    <mxCell id="e11" value="MCP Tool" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#D97706;fontSize=9;exitX=0.3;exitY=0;entryX=0.5;entryY=1;" edge="1" parent="1" source="ai_bg" target="samgov">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Celery → Redis -->
    <mxCell id="e12" value="Broker" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#CA8A04;fontSize=9;" edge="1" parent="1" source="celery_worker" target="redis">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Celery → PostgreSQL -->
    <mxCell id="e13" value="Results / Data" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#CA8A04;fontSize=9;" edge="1" parent="1" source="celery_worker" target="postgres">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- AI Orchestrator → Langfuse -->
    <mxCell id="e14" value="Traces" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#C026D3;fontSize=9;" edge="1" parent="1" source="ai_bg" target="langfuse">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Realtime → Redis -->
    <mxCell id="e15" value="Pub/Sub" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#F97316;fontSize=9;" edge="1" parent="1" source="rt_bg" target="redis">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- Django → Celery (dispatch) -->
    <mxCell id="e16" value="Task dispatch" style="edgeStyle=orthogonalEdgeStyle;rounded=0;html=1;strokeColor=#22C55E;fontSize=9;dashed=1;" edge="1" parent="1" source="django_bg" target="celery_worker">
      <mxGeometry relative="1" as="geometry" />
    </mxCell>

    <!-- ═══════════════════════════════════════════════════════════════
         LEGEND
    ═══════════════════════════════════════════════════════════════ -->
    <mxCell id="legend_bg" value="" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#F8FAFC;strokeColor=#94A3B8;" vertex="1" parent="1">
      <mxGeometry x="1390" y="325" width="210" height="240" as="geometry" />
    </mxCell>
    <mxCell id="legend_title" value="Legend" style="text;html=1;fontStyle=1;fontSize=12;fillColor=none;strokeColor=none;" vertex="1" parent="1">
      <mxGeometry x="1400" y="330" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg1" value="Frontend Service" style="rounded=1;fillColor=#EFF6FF;strokeColor=#3B82F6;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="360" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg2" value="Backend (Django) API" style="rounded=1;fillColor=#F0FDF4;strokeColor=#22C55E;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="392" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg3" value="AI Orchestrator" style="rounded=1;fillColor=#FAF5FF;strokeColor=#A855F7;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="424" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg4" value="Realtime (Node.js)" style="rounded=1;fillColor=#FFF7ED;strokeColor=#F97316;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="456" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg5" value="Data Storage" style="rounded=1;fillColor=#F1F5F9;strokeColor=#64748B;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="488" width="190" height="25" as="geometry" />
    </mxCell>
    <mxCell id="leg6" value="External Service" style="rounded=1;fillColor=#FEF3C7;strokeColor=#D97706;fontSize=10;" vertex="1" parent="1">
      <mxGeometry x="1400" y="520" width="190" height="25" as="geometry" />
    </mxCell>

  </root>
</mxGraphModel>
